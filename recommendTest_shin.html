<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-MJ9DFS4');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src="main.js"></script>
    <script src="scriptAPP.js"></script>

    <title>數位助理情境實驗3</title>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MJ9DFS4" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="container">
        <div class="questionArea">
            <!-- <div class="textTitle">您覺得欣欣商城的熱銷推薦系統像真人嗎？</div> -->
            <div class="pictureArea"></div>
            <!-- <div class="pictureArea">
               
                <img src="pictures/main1.png" class="mainPicture" alt=""> 
             
            </div> -->
        </div>
        <div class="answerArea">
            <!-- <button class="btn btn-success btnYes" name="btnYes" onclick="sayYes()">Yes</button>
            <button class="btn btn-danger btnNo" name="btnYes" onclick="sayNo()">No</button> -->
            <div class="buyText1">非常不想購買</div>
            <button class="btn btn-primary btn1" onclick="say3(1)">1</button>
            <button class="btn btn-primary btn2" onclick="say3(2)">2</button>
            <button class="btn btn-primary btn3" onclick="say3(3)">3</button>
            <button class="btn btn-primary btn4" onclick="say3(4)">4</button>
            <button class="btn btn-primary btn5" onclick="say3(5)">5</button>
            <button class="btn btn-primary btn6" onclick="say3(6)">6</button>
            <div class="buyText2">非常想購買</div>
            <div class="clear"></div>
        </div>
    </div>
</body>

<script>
    window.onload = function () {
        window.document.documentElement.scrollTop = 800;
    }
    // ****************
    // function fn() {
    //     $(".btnNext").attr("disabled", false)
    // }


    var recommendList = []
    var sport = false;
    var life = false;
    var food = false;
    var home = false;
    var computer = false;
    var accessory = false;

    var questionsNum;
    var picturesList = getRandomList(questionsNum);
    var questionsCount = 0;
    var yesCount = 0, noCount = 0;
    var btn1Count = 0, btn2Count = 0, btn3Count = 0, btn4Count = 0, btn5Count = 0, btn6Count = 0;

    // 呼叫 function say3()
    window.onload = function () {
        start3();
    };



    function start3() {
        var falseRecommendList = []
        var falseRecommendListMax = []
        sport = getUrlParameter('sport');
        life = getUrlParameter('life');
        food = getUrlParameter('food');
        home = getUrlParameter('home');
        computer = getUrlParameter('computer');
        accessory = getUrlParameter('accessory');

        if (sport == 'true') {
            recommendList.push('sport/sport' + (getRandom(maxSport) + 1));
        }
        else {
            falseRecommendList.push('sport')
            falseRecommendListMax.push(maxSport);
        }

        if (life == 'true') {
            recommendList.push('life/life' + (getRandom(maxLife) + 1));
        }
        else {
            falseRecommendList.push('life')
            falseRecommendListMax.push(maxLife);
        }

        if (food == 'true') {
            recommendList.push('food/food' + (getRandom(maxFood) + 1));
        }
        else {
            falseRecommendList.push('food')
            falseRecommendListMax.push(maxFood);
        }

        if (home == 'true') {
            recommendList.push('home/home' + (getRandom(maxHome) + 1));
        }
        else {
            falseRecommendList.push('home')
            falseRecommendListMax.push(maxHome);
        }

        if (computer == 'true') {
            recommendList.push('computer/computer' + (getRandom(maxComputer) + 1));
        }
        else {
            falseRecommendList.push('computer')
            falseRecommendListMax.push(maxComputer);
        }

        if (accessory == 'true') {
            recommendList.push('accessory/accessory' + (getRandom(maxAccessory) + 1));
        }
        else {
            falseRecommendList.push('accessory')
            falseRecommendListMax.push(maxAccessory);
        }

        var i = 0
        while (i < 3) {
            var nowPushNum = getRandom(falseRecommendList.length);
            var pushString = falseRecommendList[nowPushNum] + '/' + falseRecommendList[nowPushNum] + (getRandom(falseRecommendListMax[nowPushNum]) + 1);
            var checkRepeat = 0;
            for (var j = 0; j < recommendList.length; j++) {
                if (recommendList[j] == pushString) {
                    checkRepeat = 1;
                }
            }

            if (checkRepeat != 1) {
                recommendList.push(pushString);
                i++;
            }


        }
        // questionsNum = recommendList.length;
        questionsNum = 9;

        $(".buyText1").show(); $(".buyText2").show(); $(".btn1").show(); $(".btn2").show(); $(".btn3").show(); $(".btn4").show(); $(".btn5").show(); $(".btn6").show();
        var mainPicture = document.querySelector('.pictureArea');
        //   mainPicture.innerHTML = '<div class="interactive">依據欣欣推薦系統的介紹，您覺得欣欣推薦系統有多像真人？</div>';
        mainPicture.innerHTML = '<div class="phone"><img src="pictures/shin.png" alt="" class="icon"> <div class="iconTalk">欣欣購物平台推薦此特賣商品給您，請問您想購買嗎？</div>  <div class="productPic"><img src="pic_only/sport/4.png" alt=""></div>  </div>';
    }


    // excel
    // local storage : 存放答案與圖片的list
    // 紀錄推薦1~3的圖片跟喜好度
    // 4以後的ans是個人化問項

    function say3(x) {
        questionsCount++;

        var ask = '非推薦題'
        if ((questionsCount - 2) >= 0) {
            ask = recommendList[questionsCount - 2] + '.png'
        }

        switch (x) {
            case 1:
                btn1Count++;
                localStorage.setItem('shinPng' + String(questionsCount), ask);
                localStorage.setItem('shinAns' + String(questionsCount), '1');
                break;

            case 2:
                btn2Count++;
                localStorage.setItem('shinPng' + String(questionsCount), ask);
                localStorage.setItem('shinAns' + String(questionsCount), '2');
                break;

            case 3:
                btn3Count++;
                localStorage.setItem('shinPng' + String(questionsCount), ask);
                localStorage.setItem('shinAns' + String(questionsCount), '3');
                break;

            case 4:
                btn4Count++;
                localStorage.setItem('shinPng' + String(questionsCount), ask);
                localStorage.setItem('shinAns' + String(questionsCount), '4');
                break;

            case 5:
                btn5Count++;
                localStorage.setItem('shinPng' + String(questionsCount), ask);
                localStorage.setItem('shinAns' + String(questionsCount), '5');
                break;

            case 6:
                btn6Count++;
                localStorage.setItem('shinPng' + String(questionsCount), ask);
                localStorage.setItem('shinAns' + String(questionsCount), '6');
                break;
        }


        // document.querySelector('.textTitle').innerHTML = '以下是我們的精選熱銷商品，推薦給您';
        document.querySelector('.buyText1').innerHTML = '非常不想購買';
        document.querySelector('.buyText2').innerHTML = '非常想購買';
        var mainPicture = document.querySelector('.pictureArea');
        if (questionsCount <= (questionsNum - 4)) {
            mainPicture.innerHTML = '<div class="phone"><img src="pictures/shin.png" alt="" class="icon"> <div class="iconTalk">欣欣購物平台推薦此特賣商品給您，請問您想購買嗎？</div>  <div class="productPic"><img src="pic_only/sport/' + questionsCount + '.png" alt=""></div>  </div>';
        }
        else if (questionsCount <= (questionsNum - 3)) {
            document.querySelector('.buyText1').innerHTML = '非常不像';
            document.querySelector('.buyText2').innerHTML = '非常像';
            mainPicture.innerHTML = '<div class="interactive">根據剛剛和小艾的互動，您覺得小艾有多像真人？</div>';
        }
        else if (questionsCount <= (questionsNum - 2)) {
            document.querySelector('.buyText1').innerHTML = '非常不像';
            document.querySelector('.buyText2').innerHTML = '非常像';
            mainPicture.innerHTML = '<div class="interactive">根據剛剛和AI助理的互動，您覺得AI助理有多像真人？</div>';
        }
        else if (questionsCount <= (questionsNum - 1)) {
            document.querySelector('.buyText1').innerHTML = '非常不像';
            document.querySelector('.buyText2').innerHTML = '非常像';
            mainPicture.innerHTML = '<div class="interactive">依據欣欣推薦系統的介紹，您覺得欣欣推薦系統有多像真人？</div>';
        }
        else {
            sendSheet3(fn)
            //  window.location.href = "thanks.html"
        }
    }
    function say3_2() {
        btn2Count++;
        questionsCount++;
        var ask = '非推薦題'
        if ((questionsCount - 2) >= 0) {
            ask = recommendList[questionsCount - 2] + '.png'
        }
        localStorage.setItem('shinPng' + String(questionsCount), ask);
        localStorage.setItem('shinAns' + String(questionsCount), '2');
        // document.querySelector('.textTitle').innerHTML = '以下是我們的精選熱銷商品，推薦給您';
        document.querySelector('.buyText1').innerHTML = '非常不想購買';
        document.querySelector('.buyText2').innerHTML = '非常想購買';
        var mainPicture = document.querySelector('.pictureArea');
        if (questionsCount <= questionsNum) {
            mainPicture.innerHTML = '<div class="phone"><img src="pictures/shin.png" alt="" class="icon"> <div class="iconTalk">欣欣購物平台推薦此特賣商品給您，請問您想購買嗎？</div>  <div class="productPic"><img src="pic_only/sport/' + questionsCount + '.png" alt=""></div>  </div>';
        }
        else {
            sendSheet3(callbackFn)
            //  window.location.href = "thanks.html"
        }
    }
    function say3_3() {
        btn3Count++;
        questionsCount++;
        var ask = '非推薦題'
        if ((questionsCount - 2) >= 0) {
            ask = recommendList[questionsCount - 2] + '.png'
        }
        localStorage.setItem('shinPng' + String(questionsCount), ask);
        localStorage.setItem('shinAns' + String(questionsCount), '3');
        document.querySelector('.textTitle').innerHTML = '以下是我們的精選熱銷商品，推薦給您';
        document.querySelector('.buyText1').innerHTML = '非常不想購買';
        document.querySelector('.buyText2').innerHTML = '非常想購買';
        var mainPicture = document.querySelector('.pictureArea');
        if (questionsCount <= questionsNum) {
            mainPicture.innerHTML = '<img src="pictures/' + recommendList[questionsCount - 1] + '.png" class="mainPicture" alt=""> ';
        }
        else {
            sendSheet3(callbackFn)
            //  window.location.href = "thanks.html"
        }
    }
    function say3_4() {
        btn4Count++;
        questionsCount++;
        var ask = '非推薦題'
        if ((questionsCount - 2) >= 0) {
            ask = recommendList[questionsCount - 2] + '.png'
        }
        localStorage.setItem('shinPng' + String(questionsCount), ask);
        localStorage.setItem('shinAns' + String(questionsCount), '4');
        document.querySelector('.textTitle').innerHTML = '以下是我們的精選熱銷商品，推薦給您';
        document.querySelector('.buyText1').innerHTML = '非常不想購買';
        document.querySelector('.buyText2').innerHTML = '非常想購買';
        var mainPicture = document.querySelector('.pictureArea');
        if (questionsCount <= questionsNum) {
            mainPicture.innerHTML = '<img src="pictures/' + recommendList[questionsCount - 1] + '.png" class="mainPicture" alt=""> ';
        }
        else {
            sendSheet3(callbackFn)
            //  window.location.href = "thanks.html"
        }
    }
    function say3_5() {
        btn5Count++;
        questionsCount++;
        var ask = '非推薦題'
        if ((questionsCount - 2) >= 0) {
            ask = recommendList[questionsCount - 2] + '.png'
        }
        localStorage.setItem('shinPng' + String(questionsCount), ask);
        localStorage.setItem('shinAns' + String(questionsCount), '5');
        document.querySelector('.textTitle').innerHTML = '以下是我們的精選熱銷商品，推薦給您';
        document.querySelector('.buyText1').innerHTML = '非常不想購買';
        document.querySelector('.buyText2').innerHTML = '非常想購買';
        var mainPicture = document.querySelector('.pictureArea');
        if (questionsCount <= questionsNum) {
            mainPicture.innerHTML = '<img src="pictures/' + recommendList[questionsCount - 1] + '.png" class="mainPicture" alt=""> ';
        }
        else {
            sendSheet3(callbackFn)
            //  window.location.href = "thanks.html"
        }
    }
    function say3_6() {
        btn6Count++;
        questionsCount++;
        var ask = '非推薦題'
        if ((questionsCount - 2) >= 0) {
            ask = recommendList[questionsCount - 2] + '.png'
        }
        localStorage.setItem('shinPng' + String(questionsCount), ask);
        localStorage.setItem('shinAns' + String(questionsCount), '6');
        document.querySelector('.textTitle').innerHTML = '以下是我們的精選熱銷商品，推薦給您';
        document.querySelector('.buyText1').innerHTML = '非常不想購買';
        document.querySelector('.buyText2').innerHTML = '非常想購買';
        var mainPicture = document.querySelector('.pictureArea');
        if (questionsCount <= questionsNum) {
            mainPicture.innerHTML = '<img src="pictures/' + recommendList[questionsCount - 1] + '.png" class="mainPicture" alt=""> ';
        }
        else {
            sendSheet3(callbackFn)
            //  window.location.href = "thanks.html"
        }
    }

    function callbackFn() {
        window.location.href = "thanks.html";
    }



</script>

</html>